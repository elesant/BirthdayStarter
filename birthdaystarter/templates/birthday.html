{% extends "base_app.html" %}
{% load compress %}

{% block title %}Birthday Starter{% endblock %}

{% block content %}

<div class="container">
  <div class="row">
    <div class="span8">
      <div class="birthday-user-info">
        <div class="row">
          <div class="span2">
            <img class="birthday-facebook-image" src="https://graph.facebook.com/{{ facebook_user.id }}/picture?type=large&amp;width=180&amp;height=180">
          </div>
          <div class="span6">
            <div class="birthday-user-text">
              <p class="birthday-name-paragraph">
                {{ facebook_user.name }}
              </p>
              <p class="birthday-name-paragraph">
                &nbsp;({{ birthday.birthday }})
              </p>
            </div>
            <br>
            <div class="birthday-completion-data">
              {{ days_left }} days until Michael's birthday
              <div class="birthday-progress progress progress-danger">
                <div class="bar" style="width: {{ percentage }}%"></div>
                <div class="birthday-contributions-info">
                  {{ num_contributions }} Contributions
                </div>
              </div>
            </div>
            <div class="birthday-completion-stats">
              <div class="row">
                <div class="span2 birthday-funded-info">
                  {{ percentage }}%<br>Funded
                </div>
                <div class="span2 birthday-contributed-info">
                  ${{ amount_raised }}<br>Funded
                </div>
                <div class="span2">
                  ${{ amount_target }}<br>Required
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
    <div class="span4">
      Contributors
    </div>
  </div>
  <div id="birthday-gift-ideas">

  </div>
  <input id="input-parse-link" type="text" placeholder="Paste Item URL Here...">
</div>

{% verbatim %}
<script id="product-box-template" type="text/x-handlebars-template">
</script>
{% endverbatim %}

{% compress js %}
<script src="{{ STATIC_URL }}js/birthday.js"></script>
<script>
$('#input-parse-link').change(function() {
  $.ajax({
    type: 'POST',
    url: '/api/present/parse/',
    data: {
      'birthday_id': {{ birthday.id }},
      'item_link': $(this).val(),
    },
    success: function(data){
      $('#item-panel').html('');
      $('#item-panel').append(data['name'] + '<br />');
      $('#item-panel').append('$' + data['cost'] + '<br />');
      $('#item-panel').append('<img src="' + data['image_link'] + '"><br />');
    }
  });
});
</script>
{% endcompress %}

{% endblock %}
